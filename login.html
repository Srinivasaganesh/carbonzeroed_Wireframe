<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SustainIQ - Unified Intelligence Platform</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #06402B 0%, #0a5d35 100%);
            height: 100vh;
            overflow: hidden;
        }

        .dashboard-container {
            display: flex;
            height: 100vh;
            background: #ffffff;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.1);
        }

        /* Sidebar Styling */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #06402B 0%, #0a5d35 50%, #0f7a40 100%);
            color: white;
            padding: 0;
            position: relative;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="50" r="0.3" fill="rgba(255,255,255,0.05)"/><circle cx="50" cy="90" r="0.4" fill="rgba(255,255,255,0.08)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
            pointer-events: none;
        }

        .logo-section {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 22px;
            font-weight: 700;
            color: #ffffff;
            text-decoration: none;
            cursor: pointer;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #0f7a40, #06402B);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 20px;
            box-shadow: 0 4px 15px rgba(6, 64, 43, 0.3);
        }

        .nav-section {
            padding: 20px 0;
            position: relative;
            z-index: 1;
        }

        .nav-header {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 20px 15px;
            margin-top: 20px;
        }

        .nav-header:first-child {
            margin-top: 0;
        }

        .nav-item {
            margin: 4px 12px;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 16px 20px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: #d1fae5;
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            transform: translateX(4px);
        }

        .nav-link:hover::before {
            transform: scaleY(1);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.15);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .nav-link.active::before {
            transform: scaleY(1);
        }

        .nav-text {
            font-size: 16px;
            font-weight: 500;
        }

        .nav-icon {
            width: 20px;
            margin-right: 12px;
            text-align: center;
        }

        .sub-nav {
            margin-left: 20px;
            margin-top: 8px;
            border-left: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sub-nav-item {
            margin: 2px 0;
        }

        .sub-nav-link {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .sub-nav-link:hover {
            color: #ffffff;
            background: rgba(255, 255, 255, 0.1);
        }

        .sub-nav-link.active {
            color: #d1fae5;
            background: rgba(209, 250, 229, 0.1);
        }

        /* Main Content Area */
        .main-content {
            flex: 1;
            background: #ffffff;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: #ffffff;
            padding: 20px 30px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }

        .header-title {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            background: linear-gradient(135deg, #06402B, #0f7a40);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: #f3f4f6;
            border-radius: 50px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
        }

        .content-area {
            flex: 1;
            background: linear-gradient(135deg, #06402B 0%, #0a5d35 100%);
            overflow-y: auto;
            position: relative;
        }

        /* All Interface Sections */
        .interface-section {
            padding: 30px;
            min-height: 100%;
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .interface-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(10px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        /* Welcome Screen */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100%;
            text-align: center;
            padding: 60px 30px;
        }

        .welcome-icon {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            color: #06402B;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(209, 250, 229, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .welcome-title {
            font-size: 36px;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 16px;
        }

        .welcome-subtitle {
            font-size: 18px;
            color: #d1fae5;
            max-width: 600px;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        /* Feature Cards Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 40px;
            max-width: 1000px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .feature-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 24px;
            color: white;
        }

        .feature-title {
            font-size: 18px;
            font-weight: 600;
            color: white;
            margin-bottom: 10px;
        }

        .feature-description {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.4;
        }

        /* Card Styling */
        .interface-card {
            background: #ffffff;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            margin: 0 auto;
            max-width: 1200px;
        }

        .interface-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .interface-title {
            font-size: 32px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 12px;
        }

        .interface-description {
            font-size: 16px;
            color: #6b7280;
            line-height: 1.5;
        }

        /* Webhook Configuration */
        .webhook-config {
            background: rgba(6, 64, 43, 0.05);
            border: 1px solid rgba(6, 64, 43, 0.2);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .webhook-config h3 {
            color: #06402B;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .webhook-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 14px;
            font-family: 'Monaco', 'Menlo', monospace;
            transition: all 0.3s ease;
            background: #ffffff;
        }

        .webhook-input:focus {
            outline: none;
            border-color: #06402B;
            box-shadow: 0 0 0 4px rgba(6, 64, 43, 0.1);
        }

        /* File Drop Zone */
        .file-drop-zone {
            border: 3px dashed #d1d5db;
            border-radius: 20px;
            padding: 60px 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .file-drop-zone::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(6, 64, 43, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .file-drop-zone:hover {
            border-color: #06402B;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }

        .file-drop-zone:hover::before {
            opacity: 1;
        }

        .file-drop-zone.dragover {
            border-color: #0a5d35;
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            transform: scale(1.02);
        }

        .drop-icon {
            font-size: 64px;
            color: #9ca3af;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .file-drop-zone:hover .drop-icon {
            color: #06402B;
            transform: scale(1.1);
        }

        .drop-text {
            font-size: 20px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .drop-subtext {
            font-size: 14px;
            color: #6b7280;
        }

        .file-input {
            display: none;
        }

        /* Progress Section */
        .progress-section {
            margin-top: 30px;
            display: none;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }

        .progress-step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 20px;
            right: -50%;
            width: 100%;
            height: 2px;
            background: #e5e7eb;
            z-index: 1;
        }

        .progress-step.completed::after {
            background: #06402B;
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
            transition: all 0.3s ease;
        }

        .step-circle.active {
            background: #06402B;
            color: white;
            animation: pulse 2s infinite;
        }

        .step-circle.completed {
            background: #06402B;
            color: white;
        }

        .step-label {
            font-size: 12px;
            color: #6b7280;
            text-align: center;
        }

        .step-circle.active + .step-label,
        .step-circle.completed + .step-label {
            color: #06402B;
            font-weight: 600;
        }

        /* API Status Display */
        .api-status {
            margin-top: 20px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
            display: none;
        }

        .api-status h4 {
            margin-bottom: 15px;
            color: #1f2937;
            font-size: 16px;
        }

        .api-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            margin: 5px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #e5e7eb;
        }

        .api-item.loading {
            border-left-color: #fbbf24;
        }

        .api-item.success {
            border-left-color: #06402B;
        }

        .api-item.error {
            border-left-color: #ef4444;
        }

        .api-name {
            font-weight: 500;
            color: #1f2937;
        }

        .api-status-text {
            font-size: 14px;
            color: #6b7280;
        }

        .api-status-text.loading {
            color: #fbbf24;
        }

        .api-status-text.success {
            color: #06402B;
        }

        .api-status-text.error {
            color: #ef4444;
        }

        /* Files Preview */
        .files-preview {
            margin-top: 30px;
            display: none;
        }

        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .file-item {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .file-item:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .file-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #06402B, #0a5d35);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin-right: 16px;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .file-details {
            font-size: 14px;
            color: #6b7280;
        }

        /* Categories Section */
        .categories-section {
            display: none;
            margin-top: 30px;
        }

        .categories-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .categories-title {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .categories-description {
            font-size: 16px;
            color: #6b7280;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }

        .category-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 25px;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #06402B, #0a5d35);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .category-card:hover {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transform: translateY(-4px);
        }

        .category-card:hover::before {
            transform: scaleX(1);
        }

        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .category-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 16px;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
        }

        .category-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
        }

        .category-textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 14px;
            resize: vertical;
            transition: all 0.3s ease;
            font-family: inherit;
            line-height: 1.5;
        }

        .category-textarea:focus {
            outline: none;
            border-color: #06402B;
            box-shadow: 0 0 0 4px rgba(6, 64, 43, 0.1);
        }

        .category-textarea::placeholder {
            color: #9ca3af;
        }

        /* Submit Section */
        .submit-section {
            display: none;
            margin-top: 30px;
            text-align: center;
        }

        .submit-button {
            background: linear-gradient(135deg, #06402B 0%, #0a5d35 100%);
            color: white;
            border: none;
            padding: 18px 48px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 8px 25px rgba(6, 64, 43, 0.3);
        }

        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(6, 64, 43, 0.4);
        }

        .submit-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Forms and Controls */
        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .form-col {
            flex: 1;
            min-width: 250px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            background: #ffffff;
        }

        .form-input:focus {
            outline: none;
            border-color: #06402B;
            box-shadow: 0 0 0 3px rgba(6, 64, 43, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }

        .form-hint {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #06402B 0%, #0a5d35 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(6, 64, 43, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(6, 64, 43, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #ffffff;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-secondary:hover {
            background: #f9fafb;
            transform: translateY(-1px);
        }

        .btn.loading {
            position: relative;
            pointer-events: none;
            opacity: .85;
        }

        .btn.loading:after {
            content: '';
            position: absolute;
            right: 10px;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.7);
            border-top-color: rgba(255,255,255,0.1);
            border-radius: 50%;
            animation: spin .7s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Status Messages */
        .status-message {
            margin-top: 20px;
            padding: 16px 20px;
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .status-success {
            background: rgba(6, 64, 43, 0.1);
            border: 1px solid rgba(6, 64, 43, 0.3);
            color: #06402B;
        }

        .status-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #991b1b;
        }

        .status-info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #1e40af;
        }

        /* HTML Actions Section */
        .html-actions-section {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 1px solid #bbf7d0;
            border-radius: 16px;
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .html-actions-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .html-actions-title {
            color: #06402B;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .html-actions-subtitle {
            color: #059669;
            font-size: 14px;
        }

        .html-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .html-action-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .html-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .html-action-btn.preview {
            color: #3b82f6;
            border: 1px solid #93c5fd;
        }

        .html-action-btn.open {
            color: #06402B;
            border: 1px solid #bbf7d0;
        }

        .html-action-btn.download {
            color: #059669;
            border: 1px solid #a7f3d0;
        }

        .html-action-btn.copy {
            color: #8b5cf6;
            border: 1px solid #c4b5fd;
        }

        /* Tables */
        .table-container {
            background: #ffffff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            display: none;
        }

        .table-container.active {
            display: block;
        }

        .table-wrapper {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .data-table th {
            background: linear-gradient(135deg, #06402B, #0a5d35);
            color: white;
            padding: 1rem 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table td {
            padding: 0.875rem 0.75rem;
            border-bottom: 1px solid #e5e7eb;
            vertical-align: top;
            color: #374151;
        }

        .data-table tr:hover {
            background: #f9fafb;
        }

        .cell-ellipsis {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .editable {
            cursor: pointer;
            background-color: #f9fafb;
        }

        .editable:hover {
            background-color: rgba(6, 64, 43, 0.05);
        }

        .saving {
            opacity: 0.6;
            font-style: italic;
        }

        /* Pagination */
        .pagination-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            background: #f9fafb;
            border-top: 1px solid #e5e7eb;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .pagination-info {
            color: #6b7280;
            font-size: 0.875rem;
        }

        .pagination-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .pagination-buttons button {
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            background: #ffffff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .pagination-buttons button:hover:not(:disabled) {
            background: #f9fafb;
            border-color: #06402B;
        }

        .pagination-buttons button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-indicator {
            padding: 0.5rem 0.75rem;
            color: #6b7280;
            font-weight: 500;
            font-size: 0.875rem;
        }

        .page-size-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            font-size: 0.875rem;
        }

        /* Loading States */
        .loading-container {
            display: none;
            justify-content: center;
            align-items: center;
            padding: 3rem;
            text-align: center;
        }

        .loading-container.active {
            display: flex;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-left-color: #06402B;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        .loading-text {
            color: #6b7280;
            font-weight: 500;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #06402B;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        /* API Response Display */
        .response-section {
            margin-top: 30px;
            display: none;
        }

        .response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 0 5px;
        }

        .response-title {
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
        }

        .response-controls {
            display: flex;
            gap: 10px;
        }

        .control-button {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            background: #f9fafb;
            border-color: #06402B;
        }

        .response-container {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            max-height: 400px;
            overflow-y: auto;
            position: relative;
        }

        .response-tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
            border-radius: 16px 16px 0 0;
        }

        .response-tab {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #6b7280;
        }

        .response-tab:first-child {
            border-radius: 16px 0 0 0;
        }

        .response-tab.active {
            color: #06402B;
            border-bottom-color: #06402B;
            background: #ffffff;
        }

        .response-content {
            padding: 25px;
        }

        .response-panel {
            display: none;
        }

        .response-panel.active {
            display: block;
        }

        .response-raw {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }

        .response-formatted {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .response-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
        }

        .meta-label {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }

        .meta-value {
            font-size: 14px;
            color: #1f2937;
            font-weight: 500;
        }

        /* Controls Section */
        .controls-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: #f9fafb;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .connection-status {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .status-label {
            font-weight: 600;
            color: #1f2937;
            font-size: 0.875rem;
        }

        .status-text {
            color: #6b7280;
            font-size: 0.875rem;
        }

        /* Placeholder Content */
        .placeholder-content {
            padding: 60px 40px;
            text-align: center;
            color: #ffffff;
            font-size: 18px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 240px;
            }
            
            .categories-grid {
                grid-template-columns: 1fr;
            }
            
            .interface-section {
                padding: 20px;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .form-col {
                min-width: auto;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            
            .nav-text {
                display: none;
            }
            
            .sub-nav {
                display: none;
            }
            
            .interface-section {
                padding: 15px;
            }
            
            .interface-card {
                padding: 30px 20px;
            }
            
            .welcome-screen {
                padding: 40px 20px;
            }

            .progress-steps {
                flex-direction: column;
                gap: 20px;
            }

            .progress-step::after {
                display: none;
            }

            .html-actions {
                flex-direction: column;
            }

            .html-action-btn {
                width: 100%;
            }

            .controls-section {
                flex-direction: column;
                align-items: stretch;
            }

            .pagination-controls {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo-section">
                <div class="logo" onclick="showInterface('welcome')">
                    <div class="logo-icon">🌱</div>
                    <span>SustainIQ</span>
                </div>
            </div>

            <nav class="nav-section">
                <div class="nav-header">Data Intelligence</div>
                
                <!-- Data Extraction -->
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="extraction">
                        <i class="nav-icon fas fa-upload"></i>
                        <span class="nav-text">Data Extraction</span>
                    </a>
                    <div class="sub-nav">
                        <div class="sub-nav-item">
                            <a href="#" class="sub-nav-link" data-subsection="advanced-processing">Advanced Processing</a>
                        </div>
                        <div class="sub-nav-item">
                            <a href="#" class="sub-nav-link" data-subsection="custom-agent">Custom Agent</a>
                        </div>
                    </div>
                </div>

                <div class="nav-header">Data Management</div>
                
                <!-- Data Verification -->
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="verification">
                        <i class="nav-icon fas fa-check-circle"></i>
                        <span class="nav-text">Data Verification</span>
                    </a>
                </div>

                <div class="nav-header">Analysis Modules</div>

                <!-- Emission Analysis -->
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="emission">
                        <i class="nav-icon fas fa-chart-line"></i>
                        <span class="nav-text">Emission Analysis</span>
                    </a>
                    <div class="sub-nav">
                        <div class="sub-nav-item">
                            <a href="#" class="sub-nav-link" data-subsection="dataset-choice">Dataset Choice</a>
                        </div>
                        <div class="sub-nav-item">
                            <a href="#" class="sub-nav-link" data-subsection="emission-calculation">Emission Calculation</a>
                        </div>
                    </div>
                </div>

                <div class="nav-header">Reporting</div>

                <!-- Report Generation -->
                <div class="nav-item">
                    <a href="#" class="nav-link" data-section="reporting">
                        <i class="nav-icon fas fa-file-alt"></i>
                        <span class="nav-text">Sustainability Reporting</span>
                    </a>
                </div>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <header class="header">
                <h1 class="header-title">Sustainability Intelligence Platform</h1>
                <div class="header-actions">
                    <div class="status-badge">
                        <div class="status-dot"></div>
                        <span>System Online</span>
                    </div>
                </div>
            </header>

            <div class="content-area">
                <!-- Welcome Screen -->
                <div id="welcome-screen" class="interface-section active">
                    <div class="welcome-screen">
                        <div class="welcome-icon">🌱</div>
                        <h1 class="welcome-title">Welcome to SustainIQ</h1>
                        <p class="welcome-subtitle">
                            Your comprehensive sustainability intelligence platform with advanced data extraction, 
                            verification, emission analysis, and automated reporting capabilities.
                        </p>
                        
                        <div class="features-grid">
                            <div class="feature-card" onclick="showInterface('advanced-processing')">
                                <div class="feature-icon">📊</div>
                                <div class="feature-title">Advanced Processing</div>
                                <div class="feature-description">Smart sequential processing with intelligent HTML rendering</div>
                            </div>
                            <div class="feature-card" onclick="showInterface('custom-agent')">
                                <div class="feature-icon">🤖</div>
                                <div class="feature-title">Custom Agent</div>
                                <div class="feature-description">Create AI agents for automated data extraction</div>
                            </div>
                            <div class="feature-card" onclick="showInterface('verification')">
                                <div class="feature-icon">✅</div>
                                <div class="feature-title">Data Verification</div>
                                <div class="feature-description">Verify and validate sustainability data</div>
                            </div>
                            <div class="feature-card" onclick="showInterface('dataset-choice')">
                                <div class="feature-icon">📈</div>
                                <div class="feature-title">Emission Analysis</div>
                                <div class="feature-description">Calculate and analyze carbon emissions</div>
                            </div>
                            <div class="feature-card" onclick="showInterface('reporting')">
                                <div class="feature-icon">📄</div>
                                <div class="feature-title">Sustainability Reports</div>
                                <div class="feature-description">Generate comprehensive sustainability reports</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Processing Interface -->
                <div id="advanced-processing-interface" class="interface-section">
                    <div class="interface-card">
                        <div class="interface-header">
                            <h2 class="interface-title">Advanced Processing Pipeline</h2>
                            <p class="interface-description">Smart sequential processing with intelligent HTML rendering and multiple fallback systems</p>
                        </div>

                        <!-- Progress Tracker -->
                        <div class="progress-section" id="progressSection">
                            <div class="progress-steps">
                                <div class="progress-step" id="step1">
                                    <div class="step-circle">1</div>
                                    <div class="step-label">File Upload</div>
                                </div>
                                <div class="progress-step" id="step2">
                                    <div class="step-circle">2</div>
                                    <div class="step-label">Parallel Processing</div>
                                </div>
                                <div class="progress-step" id="step3">
                                    <div class="step-circle">3</div>
                                    <div class="step-label">Smart Extraction</div>
                                </div>
                            </div>

                            <!-- API Status Display -->
                            <div class="api-status" id="apiStatus">
                                <h4>API Processing Status</h4>
                                <div class="api-item" id="webhook1">
                                    <span class="api-name">Processing Agent 1 (Energy_Utilities)</span>
                                    <span class="api-status-text">Waiting...</span>
                                </div>
                                <div class="api-item" id="webhook2">
                                    <span class="api-name">Processing Agent 2 (water_land)</span>
                                    <span class="api-status-text">Waiting...</span>
                                </div>
                                <div class="api-item" id="webhook3">
                                    <span class="api-name">Processing Agent 3 (Fuels_and_Combustion)</span>
                                    <span class="api-status-text">Waiting...</span>
                                </div>
                                <div class="api-item" id="webhook4">
                                    <span class="api-name">Processing Agent 4 (Mobility)</span>
                                    <span class="api-status-text">Waiting...</span>
                                </div>
                                <div class="api-item" id="webhook5">
                                    <span class="api-name">Processing Agent 5 (Procurement_and_waste)</span>
                                    <span class="api-status-text">Waiting...</span>
                                </div>
                                <div class="api-item" id="extraction">
                                    <span class="api-name">Smart Extraction API</span>
                                    <span class="api-status-text">Waiting for all webhooks...</span>
                                </div>
                            </div>
                        </div>

                        <form id="advancedUploadForm">
                            <div class="file-drop-zone" id="advancedDropZone">
                                <input type="file" id="advancedFileInput" class="file-input" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.csv,.txt,.jpg,.png">
                                <div class="drop-icon">📄</div>
                                <div class="drop-text">Drop files here or click to browse</div>
                                <div class="drop-subtext">Supports PDF, Word, Excel, CSV, and image files</div>
                            </div>

                            <div id="advancedFilesPreview" class="files-preview">
                                <h3 style="font-size: 20px; font-weight: 600; color: #1f2937; margin-bottom: 20px;">Selected Files</h3>
                                <div id="advancedFilesGrid" class="files-grid"></div>
<div id="customAgentsPicker" class="files-preview" style="margin-top: 10px;; display:block">
  <h4 style="font-size: 16px; font-weight:600; margin-bottom: 8px;">Select Custom Python Agents (optional)</h4>
  <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap;">
    <select id="customAgentsMulti" multiple size="4" style="min-width: 320px; max-width: 520px; padding:8px; border:1px solid #e5e7eb; border-radius:8px;">
      <!-- populated dynamically -->
    </select>
    <button type="button" class="submit-button" id="refreshAgentsBtn" style="width:auto; padding:8px 12px;">Refresh</button>
    <span id="customAgentsHint" style="color:#6b7280;">Hold Ctrl/Cmd to select multiple</span>
  </div>
<div id="customAgentsContexts" style="margin-top:14px; display:none;">
  <h4 style="font-size:16px; font-weight:600; margin-bottom:8px;">Custom Agent Context (optional)</h4>
  <div id="customAgentsContextsGrid" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(260px,1fr)); gap:12px;"></div>
</div>

</div>

                                <div id="advancedFilenames" style="margin-top: 15px; padding: 15px; background: #f8fafc; border-radius: 8px;">
                                    <h4 style="color: #06402B; margin-bottom: 10px;">Filenames for extraction (sent only if all webhooks succeed):</h4>
                                    <div id="advancedFilenamesList" style="font-family: monospace; color: #374151;"></div>
                                </div>
                            </div>

                            <div id="advancedCategoriesSection" class="categories-section">
                                <div class="categories-header">
                                    <h3 class="categories-title">Sustainability Categories</h3>
                                    <p class="categories-description">Optional: Provide additional context for each sustainability category</p>
                                </div>

                                <div class="categories-grid">
                                    <div class="category-card">
                                        <div class="category-header">
                                            <div class="category-icon" style="background: linear-gradient(135deg, #fbbf24, #f59e0b);">⚡</div>
                                            <div class="category-title">Energy & Utilities</div>
                                        </div>
                                        <textarea class="category-textarea" name="energy_utilities" placeholder="Describe energy consumption, utility usage, power generation, renewable energy initiatives..."></textarea>
                                    </div>

                                    <div class="category-card">
                                        <div class="category-header">
                                            <div class="category-icon" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">💧</div>
                                            <div class="category-title">Water & Land Use</div>
                                        </div>
                                        <textarea class="category-textarea" name="water_land" placeholder="Document water consumption, land usage, irrigation, conservation efforts..."></textarea>
                                    </div>

                                    <div class="category-card">
                                        <div class="category-header">
                                            <div class="category-icon" style="background: linear-gradient(135deg, #ef4444, #dc2626);">🔥</div>
                                            <div class="category-title">Fuels & Combustion</div>
                                        </div>
                                        <textarea class="category-textarea" name="fuels_combustion" placeholder="Report fuel usage, combustion processes, emissions, heating systems..."></textarea>
                                    </div>

                                    <div class="category-card">
                                        <div class="category-header">
                                            <div class="category-icon" style="background: linear-gradient(135deg, #06402B, #0a5d35);">🚗</div>
                                            <div class="category-title">Mobility</div>
                                        </div>
                                        <textarea class="category-textarea" name="mobility" placeholder="Detail transportation, vehicle usage, travel patterns, logistics..."></textarea>
                                    </div>

                                    <div class="category-card">
                                        <div class="category-header">
                                            <div class="category-icon" style="background: linear-gradient(135deg, #8b5cf6, #7c3aed);">♻️</div>
                                            <div class="category-title">Procurement, Waste & Maintenance</div>
                                        </div>
                                        <textarea class="category-textarea" name="procurement_waste" placeholder="Describe procurement processes, waste management, maintenance activities..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <div id="advancedSubmitSection" class="submit-section">
                                <button type="submit" class="submit-button" id="advancedSubmitButton">
                                    Start Advanced Processing
                                </button>
                            </div>
                        </form>

                        <div id="advancedStatusMessage" class="status-message"></div>

                        <!-- Persistent HTML Actions Section -->
                        <div id="advancedHtmlActionsSection" class="html-actions-section">
                            <div class="html-actions-header">
                                <div class="html-actions-title">HTML Report Ready</div>
                                <div class="html-actions-subtitle">Choose how you want to view or save your results</div>
                            </div>
                            <div id="advancedHtmlActions" class="html-actions">
                                <!-- Buttons will be added here -->
                            </div>
                        </div>

                        <!-- API Response Display -->
                        <div id="advancedResponseSection" class="response-section">
                            <div class="response-header">
                                <h3 class="response-title">Processing Results</h3>
                                <div class="response-controls">
                                    <button class="control-button" onclick="copyAdvancedResponse()">Copy</button>
                                    <button class="control-button" onclick="clearAdvancedResponse()">Clear</button>
                                </div>
                            </div>
                            <div class="response-container">
                                <div class="response-tabs">
                                    <div class="response-tab active" onclick="switchAdvancedTab(event, 'advanced-formatted')">Results</div>
                                    <div class="response-tab" onclick="switchAdvancedTab(event, 'advanced-raw')">Raw Data</div>
                                </div>
                                <div class="response-content">
                                    <div id="advanced-formatted" class="response-panel active">
                                        <div id="advancedResponseFormatted" class="response-formatted">
                                            No results yet. Start processing to see results here.
                                        </div>
                                    </div>
                                    <div id="advanced-raw" class="response-panel">
                                        <div id="advancedResponseRaw" class="response-raw">
                                            No results yet. Start processing to see raw data here.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Custom Agent Interface -->
                <div id="custom-agent-interface" class="interface-section">
                    <div class="interface-card">
                        <div class="interface-header">
                            <h2 class="interface-title">Custom Agent Wizard</h2>
                            <p class="interface-description">Create and deploy custom AI agents for automated data extraction workflows</p>
                        </div>
                        
                        <!-- Agent Configuration -->
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label class="form-label">Agent Name</label>
                                    <input type="text" id="agentName" class="form-input" placeholder="e.g., Packaging Waste Extractor">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Webhook Path</label>
                                    <input type="text" id="agentPath" class="form-input" placeholder="custom-agents/packaging-waste">
                                    <div class="form-hint">Auto-generated from agent name</div>
                                </div>
                                
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label class="form-label">n8n Base URL</label>
                                    <input type="text" id="n8nBaseUrl" class="form-input" value="http://localhost:5678">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">n8n API Key</label>
                                    <input type="text" id="n8nApiKey" class="form-input" placeholder="Your n8n API key" value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMmUwN2QxNy04NDJkLTQyZWEtYjQxYS00NDA5NDcxOGJiNWMiLCJpc3MiOiJuOG4iLCJhdWQiOiJwdWJsaWMtYXBpIiwiaWF0IjoxNzU3NTg0NTMzfQ.YSM83QVKL_9c7sdIMTdla_u5PscKf-2zuGttNL6IXsI">
                                </div>
                                
                            </div>
                        </div>

                        
                        </div>

                        <!-- Document Tool Prompt -->
                        <div class="form-group">
                            <label class="form-label">Document Tool Prompt</label>
                            <textarea id="documentPrompt" class="form-input form-textarea" placeholder="Enter the instructions for the document tool here...">Extract sustainability data including carbon emissions, energy consumption, waste generation, and travel data from the provided document. Focus on numerical values, dates, locations, and categorical information needed for environmental impact calculations.</textarea>
                            <div class="form-hint">Define what data the agent should extract from documents</div>
                        </div>

                        <!-- Collapsible Sections -->
                        <details open>
                            <summary style="cursor: pointer; font-weight: 600; padding: 0.75rem 0; color: #374151; border-bottom: 1px solid #e5e7eb; margin-bottom: 1rem;">Output JSON Schema</summary>
                            <div class="form-group">
                                <textarea id="jsonSchema" class="form-input" style="font-family: 'Monaco', 'Menlo', monospace; min-height: 200px;">{ 
  "items": [
    {
      "category": null,
      "date": null,
      "service_type": null,
      "fuel_type": null,
      "material": null,
      "waste_type": null,
      "recharge_type": null,
      "origin": null,
      "destination": null,
      "class_of_travel": null,
      "no_of_passengers": null,
      "trip_mode": null,
      "vehicle_model": null,
      "vehicle_make": null,
      "site": null,
      "account_type": null,
      "consumption": null,
      "unit": null,
      "amount_spent": null,
      "scope": null,
      "file_name": null
    }
  ]
}</textarea>
                            </div>
                        </details>

                        <details>
                            <summary style="cursor: pointer; font-weight: 600; padding: 0.75rem 0; color: #374151; border-bottom: 1px solid #e5e7eb; margin-bottom: 1rem;">System & User Defaults</summary>
                            <div class="form-group">
                                <label class="form-label">System Message</label>
                                <textarea id="systemMessage" class="form-input form-textarea">You are a sustainability data extraction agent.
Always return valid JSON only, no markdown, no commentary.
Follow your agent-specific instructions strictly.
Do not extract data outside your agent's assigned categories.
Ignore all unrelated data even if similar fields exist elsewhere.
If no relevant information is found, return: { "items": [] }</textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">User Message Template</label>
                                <textarea id="userMessage" class="form-input form-textarea">You are a carbon-data extraction agent. Your sole task is to extract fields that are potentially required to calculate a carbon footprint from any document.
Do not normalize values. Return exactly as found.
Be layout-robust (merged cells, multiple pages/sheets, rotated headers, multilingual).</textarea>
                            </div>
                        </details>

                        <!-- Action Buttons -->
                        <div class="form-row" style="margin-top: 2rem;">
                            <button type="button" class="btn btn-primary" id="createAgentBtn" onclick="createCustomAgent()">
                                <i class="fas fa-magic"></i>
                                Create & Activate Workflow
                            </button>
                            <button type="button" class="btn btn-secondary" id="previewJsonBtn" onclick="previewWorkflowJson()">
                                <i class="fas fa-eye"></i>
                                Preview Workflow JSON
                            </button>
                        </div>

                        <!-- Results -->
                        <div id="agentResults" style="margin-top: 2rem;"></div>
                    </div>
                </div>

                <!-- Data Verification Interface -->
                <div id="verification-interface" class="interface-section">
                    <div class="interface-card">
                        <div class="interface-header">
                            <h2 class="interface-title">Data Verification</h2>
                            <p class="interface-description">Verify and validate sustainability data for accuracy and compliance</p>
                        </div>
                        
                        <!-- Controls -->
                        <div class="controls-section">
                            <div class="connection-status">
                                <div class="status-label">Database Connection Status</div>
                                <div class="status-text" id="connectionStatus">Ready to connect to database</div>
                            </div>
                            <div class="form-row" style="margin: 0; flex: 1; max-width: 600px;">
                                <div class="form-col">
                                    <input type="text" id="webhookUrl" class="form-input" placeholder="Enter n8n webhook URL" value="http://localhost:5678/webhook/data-verification">
                                </div>
                                <button type="button" class="btn btn-primary" id="loadDataBtn" onclick="loadVerificationData()">
                                    <i class="fas fa-database"></i>
                                    Load Database Records
                                </button>
                            </div>
                        </div>

                        <!-- Loading -->
                        <div id="loadingContainer" class="loading-container">
                            <div>
                                <div class="spinner"></div>
                                <div class="loading-text">Loading database records...</div>
                            </div>
                        </div>

                        <!-- Table -->
                        <div id="dataTableContainer" class="table-container">
                            <div class="table-wrapper">
                                <table id="dataTable" class="data-table">
                                    <thead id="tableHeader"></thead>
                                    <tbody id="tableBody"></tbody>
                                </table>
                            </div>

                            <!-- Pagination -->
                            <div class="pagination-controls">
                                <div class="pagination-info">
                                    <span id="recordsInfo">Showing 0 of 0 records</span>
                                </div>
                                <div class="pagination-buttons">
                                    <button onclick="goToFirstPage()" id="firstPageBtn">
                                        <i class="fas fa-angle-double-left"></i>
                                    </button>
                                    <button onclick="goToPreviousPage()" id="prevPageBtn">
                                        <i class="fas fa-angle-left"></i>
                                    </button>
                                    <span id="pageIndicator" class="page-indicator">1 / 1</span>
                                    <button onclick="goToNextPage()" id="nextPageBtn">
                                        <i class="fas fa-angle-right"></i>
                                    </button>
                                    <button onclick="goToLastPage()" id="lastPageBtn">
                                        <i class="fas fa-angle-double-right"></i>
                                    </button>
                                </div>
                                <div class="page-size-controls">
                                    <label for="pageSizeSelect">Rows per page:</label>
                                    <select id="pageSizeSelect" class="form-input form-select" onchange="changePageSize(this.value)" style="width: auto; min-width: 80px;">
                                        <option value="10">10</option>
                                        <option value="25" selected>25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dataset Choice Interface -->
                <div id="dataset-choice-interface" class="interface-section">
                    <div class="interface-card">
                        <div class="interface-header">
                            <h2 class="interface-title">Emission Factor Dataset Upload</h2>
                            <p class="interface-description">Upload an emission factor dataset to begin the analysis and calculation process.</p>
                        </div>

                        <!-- Step 1: Upload Dataset -->
                        <div class="webhook-config">
                            <h3>Dataset Upload Webhook</h3>
                            <input type="text" class="webhook-input" id="datasetWebhookUrl" placeholder="Enter your dataset upload webhook URL here..." />
                        </div>

                        <form id="datasetUploadForm">
                            <div class="file-drop-zone" id="datasetDropZone">
                                <input type="file" id="datasetFileInput" class="file-input" accept=".csv,.xls,.xlsx">
                                <div class="drop-icon">📊</div>
                                <div class="drop-text">Drop your dataset file here or click to browse</div>
                                <div class="drop-subtext">Supports CSV, XLS, and XLSX files</div>
                            </div>

                            <div id="datasetFilesPreview" class="files-preview">
                                <h3 style="font-size: 20px; font-weight: 600; color: #1f2937; margin-bottom: 20px;">Selected Dataset</h3>
                                <div id="datasetFilesGrid" class="files-grid"></div>
                            </div>

                            <div id="datasetSubmitSection" class="submit-section">
                                <button type="submit" class="submit-button" id="datasetSubmitButton">Upload Dataset</button>
                            </div>
                        </form>

                        <div id="datasetStatusMessage" class="status-message"></div>

                        <div id="datasetResponseSection" class="response-section">
                            <div class="response-header">
                                <h3 class="response-title">Dataset Upload Response</h3>
                                <div class="response-controls">
                                    <button class="control-button" onclick="copyResponse('dataset')">Copy</button>
                                    <button class="control-button" onclick="clearResponse('datasetResponseSection')">Clear</button>
                                </div>
                            </div>
                            <div class="response-container">
                                <div class="response-tabs">
                                    <div class="response-tab active" data-type="dataset" onclick="switchTab(event, 'dataset-formatted')">Formatted</div>
                                    <div class="response-tab" data-type="dataset" onclick="switchTab(event, 'dataset-raw')">Raw JSON</div>
                                    <div class="response-tab" data-type="dataset" onclick="switchTab(event, 'dataset-meta')">Metadata</div>
                                </div>
                                <div class="response-content">
                                    <div id="dataset-formatted" class="response-panel active">
                                        <div id="datasetResponseFormatted" class="response-formatted">Waiting for dataset upload...</div>
                                    </div>
                                    <div id="dataset-raw" class="response-panel">
                                        <pre id="datasetResponseRaw" class="response-raw">Waiting for dataset upload...</pre>
                                    </div>
                                    <div id="dataset-meta" class="response-panel">
                                        <div id="datasetResponseMeta" class="response-meta">
                                            <div class="meta-item"><span class="meta-label">Status</span><span class="meta-value" id="datasetMetaStatus">-</span></div>
                                            <div class="meta-item"><span class="meta-label">Time</span><span class="meta-value" id="datasetMetaTime">-</span></div>
                                            <div class="meta-item"><span class="meta-label">Type</span><span class="meta-value" id="datasetMetaType">-</span></div>
                                            <div class="meta-item"><span class="meta-label">Size</span><span class="meta-value" id="datasetMetaSize">-</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Calculate Emission Factor -->
                        <div id="emissionCalculationSection" style="display: none; margin-top: 40px; border-top: 1px solid #e5e7eb; padding-top: 40px;">
                            <div class="interface-header">
                                <h3 class="categories-title">Emission Factor Calculation</h3>
                                <p class="categories-description">Dataset successfully processed. You can now proceed with the calculation.</p>
                            </div>
                            <div class="submit-section" style="display: block;">
                                <button type="button" class="submit-button" id="calculateEmissionButton">
                                    Calculate Emission Factor
                                </button>
                            </div>

                            <div id="calculationStatusMessage" class="status-message"></div>

                            <div id="calculationResponseSection" class="response-section">
                                <div class="response-header">
                                    <h3 class="response-title">Calculation Response</h3>
                                    <div class="response-controls">
                                        <button class="control-button" onclick="copyResponse('calculation')">Copy</button>
                                        <button class="control-button" onclick="clearResponse('calculationResponseSection')">Clear</button>
                                    </div>
                                </div>
                                <div class="response-container">
                                    <div class="response-tabs">
                                        <div class="response-tab active" data-type="calculation" onclick="switchTab(event, 'calculation-formatted')">Formatted</div>
                                        <div class="response-tab" data-type="calculation" onclick="switchTab(event, 'calculation-raw')">Raw JSON</div>
                                        <div class="response-tab" data-type="calculation" onclick="switchTab(event, 'calculation-meta')">Metadata</div>
                                    </div>
                                    <div class="response-content">
                                        <div id="calculation-formatted" class="response-panel active">
                                            <div id="calculationResponseFormatted" class="response-formatted">Waiting for calculation to be triggered...</div>
                                        </div>
                                        <div id="calculation-raw" class="response-panel">
                                            <pre id="calculationResponseRaw" class="response-raw">Waiting for calculation to be triggered...</pre>
                                        </div>
                                        <div id="calculation-meta" class="response-panel">
                                            <div id="calculationResponseMeta" class="response-meta">
                                                <div class="meta-item"><span class="meta-label">Status</span><span class="meta-value" id="calculationMetaStatus">-</span></div>
                                                <div class="meta-item"><span class="meta-label">Time</span><span class="meta-value" id="calculationMetaTime">-</span></div>
                                                <div class="meta-item"><span class="meta-label">Type</span><span class="meta-value" id="calculationMetaType">-</span></div>
                                                <div class="meta-item"><span class="meta-label">Size</span><span class="meta-value" id="calculationMetaSize">-</span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Emission Calculation Interface -->
                <div id="emission-calculation-interface" class="interface-section">
                    <div class="interface-card">
                        <div class="interface-header">
                            <h2 class="interface-title">Emission Analysis Prompts</h2>
                            <p class="interface-description">Configure AI prompts for emission analysis and calculations</p>
                        </div>

                        <div class="webhook-config">
                            <h3>Emission Analysis Webhook</h3>
                            <input type="text" class="webhook-input" id="emissionWebhookUrl" 
                                   value="http://localhost:5678/webhook/457366eb-f988-4d3c-a301-9d2f0df8f3a6" 
                                   placeholder="Enter emission analysis webhook URL..." />
                            <small style="color: #6b7280; font-size: 12px; margin-top: 8px; display: block;">
                                Configure webhook endpoint for emission analysis and prompt processing
                            </small>
                        </div>

                        <div style="margin-top: 30px;">
                            <h3 style="font-size: 20px; font-weight: 600; color: #1f2937; margin-bottom: 20px;">Prompt Configuration</h3>
                            
                            <div class="category-card" style="margin-bottom: 20px;">
                                <div class="category-header">
                                    <div class="category-icon" style="background: linear-gradient(135deg, #06402B, #0a5d35);">🌡️</div>
                                    <div class="category-title">Emission Calculation Prompts</div>
                                </div>
                                <textarea class="category-textarea" id="emissionPrompts" placeholder="Configure AI prompts for emission factor calculations, carbon footprint analysis, and GHG reporting..."></textarea>
                            </div>

                            <div class="submit-section" style="display: block; margin-top: 30px;">
                                <button type="button" class="submit-button" onclick="submitEmissionPrompts()">
                                    Update Emission Prompts
                                </button>
                            </div>
                        </div>

                        <div id="emissionStatusMessage" class="status-message"></div>

                        <!-- API Response Display for Emission Prompts -->
                        <div id="emissionResponseSection" class="response-section">
                            <div class="response-header">
                                <h3 class="response-title">Emission Prompts API Response</h3>
                                <div class="response-controls">
                                    <button class="control-button" onclick="copyResponse('emission')">Copy</button>
                                    <button class="control-button" onclick="clearResponse('emissionResponseSection')">Clear</button>
                                </div>
                            </div>
                            <div class="response-container">
                                <div class="response-tabs">
                                    <div class="response-tab active" data-type="emission" onclick="switchTab(event, 'emission-formatted')">Formatted</div>
                                    <div class="response-tab" data-type="emission" onclick="switchTab(event, 'emission-raw')">Raw JSON</div>
                                    <div class="response-tab" data-type="emission" onclick="switchTab(event, 'emission-meta')">Metadata</div>
                                </div>
                                <div class="response-content">
                                    <div id="emission-formatted" class="response-panel active">
                                        <div id="emissionResponseFormatted" class="response-formatted">
                                            No response yet. Submit emission prompts to see the API response here.
                                        </div>
                                    </div>
                                    <div id="emission-raw" class="response-panel">
                                        <pre id="emissionResponseRaw" class="response-raw">
                                            No response yet. Submit emission prompts to see the raw API response here.
                                        </pre>
                                    </div>
                                    <div id="emission-meta" class="response-panel">
                                        <div id="emissionResponseMeta" class="response-meta">
                                            <div class="meta-item">
                                                <span class="meta-label">Status</span>
                                                <span class="meta-value" id="emissionMetaStatus">-</span>
                                            </div>
                                            <div class="meta-item">
                                                <span class="meta-label">Response Time</span>
                                                <span class="meta-value" id="emissionMetaTime">-</span>
                                            </div>
                                            <div class="meta-item">
                                                <span class="meta-label">Content Type</span>
                                                <span class="meta-value" id="emissionMetaType">-</span>
                                            </div>
                                            <div class="meta-item">
                                                <span class="meta-label">Size</span>
                                                <span class="meta-value" id="emissionMetaSize">-</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sustainability Reporting Interface -->
                <div id="reporting-interface" class="interface-section active">
				  <div class="interface-card">
					<div class="interface-header">
					  <h2 class="interface-title">Sustainability Reporting</h2>
					  <p class="interface-description">Generate comprehensive sustainability reports and compliance documentation</p>
					</div>

					<div class="webhook-config">
					  <h3>n8n Webhook URL</h3>
					  <input id="n8nWebhookUrl" class="webhook-input" value="/report/generate" />
					  <div class="form-hint">
						Leave as <code>/report/generate</code> to use the new proxy.  
						(Advanced: set to <code>/webhook/report</code> or a full n8n URL if you need direct access.)
					  </div>
					</div>

					<div class="form-row" style="margin-top: 8px;">
					  <button id="btnGenerateReport" class="btn btn-primary">
						<i class="fas fa-play"></i> Generate Report
					  </button>
					  <button id="btnDownloadReport" class="btn btn-secondary" disabled>
						<i class="fas fa-download"></i> Download
					  </button>
					</div>

					<div id="reportStatus" class="status-message" style="display:none;"></div>

					<div class="interface-card" style="padding:0; margin-top:16px;">
					  <iframe id="reportIframe" style="width:100%; height:700px; border:0; display:none;"></iframe>
					  <div id="reportEmptyState" style="padding:40px; text-align:center; color:#6b7280;">
						<i class="fas fa-file-alt" style="font-size:40px; margin-bottom:12px;"></i>
						<div>Your report will appear here.</div>
					  </div>
					</div>
				  </div>
				</div>
            </div>
        </div>
    </div>
<script src="./loginxx.js"></script>
</body>
</html>